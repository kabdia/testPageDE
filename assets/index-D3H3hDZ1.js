var B=Object.defineProperty;var L=a=>{throw TypeError(a)};var A=(a,e,t)=>e in a?B(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var c=(a,e,t)=>A(a,typeof e!="symbol"?e+"":e,t),k=(a,e,t)=>e.has(a)||L("Cannot "+t);var g=(a,e,t)=>e.has(a)?L("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(a):e.set(a,t);var v=(a,e,t)=>(k(a,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const f of r.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();const l=class l{constructor(){if(l.instance)return l.instance;this.form=null,this.init("#modalWindow"),l.instance=this}static getInstance(){return l.instance||(l.instance=new l),l.instance}init(e){this.form=document.querySelector(e),this.form.addEventListener("submit",t=>this.handleSubmit(t)),this.addEventListenersToFields()}addEventListenersToFields(){this.form.querySelectorAll("input[data-js-required], textarea[data-js-required]").forEach(t=>{var s;(((s=t.getAttribute("data-js-required-mode"))==null?void 0:s.split(","))||[]).forEach(r=>{r==="blur"&&t.addEventListener("blur",()=>this.validateInput(t)),r==="change"&&t.addEventListener("change",()=>this.validateInput(t))})})}handleSubmit(){return this.validateForm()}validateForm(){const e=this.form.querySelectorAll("input[data-js-required], textarea[data-js-required]");let t=!0;return e.forEach(i=>{this.validateInput(i)||(t=!1)}),t}validateInput(e){const t=e.closest(".form-group").querySelector(".form-error-message");let i=!0;switch(e.dataset.jsRequired){case"name":e.value===""?(t.innerHTML="This field is required.",i=!1):t.innerHTML="";break;case"mail":e.value===""?(t.innerHTML="This field is required.",i=!1):/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/.test(e.value)?t.innerHTML="":(t.textContent="Неверный формат email.",i=!1);break;case"message":e.value===""?(t.innerHTML="This field is required.",i=!1):t.innerHTML=""}return i}};c(l,"instance",null);let h=l;const o=class o{constructor(){if(o.instance)return o.instance;o.instance=this}static lock(){o.body.classList.add(o.classScroll)}static unlock(){o.body.classList.remove(o.classScroll)}};c(o,"instance",null),c(o,"body",document.querySelector("body")),c(o,"classScroll","noscroll");let m=o;const n=class n{constructor(){if(n.instance)return n.instance;this.init(),n.instance=this}static getInstance(){return n.instance||(n.instance=new n),n.instance}init(){document.addEventListener("click",e=>{e.target.closest("[data-open-modal]")&&n.open({mode:"formBlock",datas:"#modalWindow"})}),document.addEventListener("click",e=>{e.target.hasAttribute("data-close-modal")&&(n.close({mode:"formBlock",datas:"#modalWindow"}),n.close({mode:"formBlock",datas:"#btnCloseModal"}),n.close({mode:"formBlock",datas:"#messageSuccess"}),n.close({mode:"formBlock",datas:"#btnCloseModalSuccess"}))})}static open({mode:e,datas:t,text:i}){let s;if(e==="formBlock"&&t)s=document.querySelector(t),s&&s.classList.add(n.stateClasses.open);else if(e==="sucessBlock"&&t){s=document.querySelector(t);const r=document.querySelector("#messageSuccessText");r.innerHTML=`<span>${i}</span>`,s.classList.add(n.stateClasses.open)}m.lock()}static close({mode:e,datas:t}){let i;(e==="formBlock"&&t||e==="sucessBlock")&&(i=document.querySelector(t),i&&i.classList.remove(n.stateClasses.open)),m.unlock()}};c(n,"instance",null),c(n,"stateClasses",{open:"modal--active",close:"modal--close"}),c(n,"attrs",{openModal:"data-open-modal",closeModal:"data-close-modal"});let p=n;var u,q,S;const d=class d{constructor(){g(this,u);c(this,"attrs",{form:"data-js-form"});if(d.instance)return d.instance;v(this,u,S).call(this),d.instance=this}static getInstance(){return d.instance||(d.instance=new d),d.instance}};u=new WeakSet,q=function(e){const{target:t}=e;if(!t.hasAttribute(`${this.attrs.form}`)||!t.tagName.toLowerCase()==="form")return;const i=JSON.parse(t.getAttribute(this.attrs.form)),{url:s,method:r="POST",showModalAfterSuccess:f,preventDefault:w=!0,isNeedValidateBeforeSend:E}=i,T=new FormData(t);w&&e.preventDefault(),!(E&&!h.getInstance().validateForm(t))&&fetch(s,{method:r,body:T}).then(b=>{b&&f&&p.open({mode:"sucessBlock",datas:"#messageSuccess",text:"Your message successfully sent"})})},S=function(){document.addEventListener("submit",e=>{v(this,u,q).call(this,e)},!0)},c(d,"instance");let y=d;function C(){return new Promise(a=>{document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{a()}):a()})}C().then(()=>{new m,new p,new h,new y});
